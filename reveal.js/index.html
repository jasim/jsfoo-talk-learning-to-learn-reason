<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>Learning to learn ReasonML</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="./css/reset.css">
  <link rel="stylesheet" href="./css/reveal.css">
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="./css/theme/serif.css" id="theme">
  <style>
    .reveal h1 {
      font-size: 2em;
    }
    
  .reveal section img {
    box-shadow: none;
    background-color: transparent;
    border: none;
  }
  
  .reveal .slides section {
    transition-duration: 200ms !important; 
  }
  </style>
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? './css/print/pdf.css' : './css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="./lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Learning to learn ReasonML</h1>
</section>

<section class="slide level2">

<pre><code>    
    LEARNING TO LEARN REASONML

    Jasim A Basheer 
    protoship.io

    @jasim_ab

</code></pre>
<p> </p>
<aside class="notes">
<p>Hello, my name is Jasim, and I’m here today to talk about ReasonML.</p>
<p>My hope through this talk is to give you a feel for the language - what makes it interesting, how is it different from Javascript, and what it feels to be programming in it on a day-to-day basis.</p>
</aside>
</section>
<section id="reason-is-ocaml" class="slide level2">
<h2>Reason is OCaml</h2>
<ul>
<li><p>First released in 1990 in France</p></li>
<li><p>Fast programs approaching C-like speeds</p></li>
<li><p>ISWIM syntax (OCaml, Haskell) not ALGOL (C, Java, Javascript etc.)</p></li>
</ul>
<aside class="notes">
<p>Reason is a new syntax on top of the OCaml programming language.</p>
<p>OCaml has a long history - it was first released in 1990 - about 20 years ago. It is a compiled language and produces very performant binaries.</p>
<p>Its syntax however is distinct from what is used in most popular languages.</p>
</aside>
</section>
<section id="ocaml-sample-code" class="slide level2">
<h2>OCaml sample code</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">let</span> <span class="kw">rec</span> read_and_accumulate accum =</span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="kw">let</span> line = In_channel.<span class="dt">input_line</span> In_channel.<span class="dt">stdin</span> <span class="kw">in</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="kw">match</span> line <span class="kw">with</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  | <span class="dt">None</span> -&gt; accum</span>
<span id="cb2-5"><a href="#cb2-5"></a>  | <span class="dt">Some</span> x -&gt; read_and_accumulate (accum +. Float.of_string x)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">let</span> () =</span>
<span id="cb2-8"><a href="#cb2-8"></a>  printf <span class="st">&quot;Total: %F</span><span class="ch">\n</span><span class="st">&quot;</span> (read_and_accumulate <span class="dv">0</span>.)  </span></code></pre></div>
<aside class="notes">
<p>Here is an OCaml program that reads a list of numbers from the standard input and prints their sum.</p>
</aside>
</section>
<section id="same-code-in-reason" class="slide level2">
<h2>Same code, in Reason</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">let</span> rec read_and_accumulate <span class="op">=</span> accum <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="kw">let</span> line <span class="op">=</span> <span class="va">In_channel</span>.<span class="at">input_line</span>(<span class="va">In_channel</span>.<span class="at">stdin</span>)<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="cf">switch</span> (line) <span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="op">|</span> None <span class="kw">=&gt;</span> accum</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="op">|</span> <span class="at">Some</span>(x) <span class="kw">=&gt;</span> <span class="at">read_and_accumulate</span>(accum <span class="op">+</span>. <span class="va">Float</span>.<span class="at">of_string</span>(x))</span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="op">};</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="op">};</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">let</span> () <span class="op">=</span> <span class="at">printf</span>(<span class="st">&quot;Total: %F</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="at">read_and_accumulate</span>(<span class="fl">0.</span>))<span class="op">;</span></span></code></pre></div>
<aside class="notes">
<p>Here’s the same OCaml code, but in the Reason syntax. This is closer to ES6 as we know it - there are braces to denote blocks. The fat arrow operator lets us create functions and semicolons for separating lines.</p>
<p>Underneath, however Reason and OCaml are the same language and have the same semantics. In this presentation I’ll use refer to Reason and OCaml interchangeably, depending on what fits the context better.</p>
</aside>
</section>
<section id="what-can-we-build-with-reasonocaml" class="slide level2">
<h2>What can we build with Reason/OCaml?</h2>
<aside class="notes">
<p>So is it actually useful? This language. What can we build with it? Let me take you through some examples.</p>
</aside>
</section>
<section class="slide level2">

<h4 id="high-frequency-trading-software">High-frequency trading software</h4>
<p> </p>
<p><img data-src="images/jane-street.png" /></p>
<aside class="notes">
<p>When you start reading about OCaml, you’ll often come across Jane Street. They are one of the largest production users of the language and they do billions of dollars worth of trading, all with software written in OCaml.</p>
</aside>
</section>
<section class="slide level2">

<h4 id="worlds-second-largest-crawler">World’s second largest crawler</h4>
<p> </p>
<p><img data-src="images/ahrefs.png" /></p>
<aside class="notes">
<p>If you have done any SEO work, you might be familiar with Ahrefs. They crawl about 5 million pages every minute, and they have the second largest index just after Google. They use native OCaml for all the back-end infra and for the front-end web they use Reason.</p>
</aside>
</section>
<section class="slide level2">

<h4 id="compilers">Compilers</h4>
<p> </p>
<ul>
<li>First version of the Rust compiler</li>
<li>Flow (typechecker for Javascript)</li>
<li>Hack (Facebook’s PHP compiler)</li>
</ul>
<p> </p>
<aside class="notes">
<p>OCaml is also particularly nice to write compilers on - in fact anything that deals with a lot of tree manipulation is a great fit. Rust borrows many ideas from OCaml, and their first compiler was written in the language. Facebook is also a large user of OCaml internally.</p>
<p>5mins</p>
</aside>
</section>
<section id="front-end-web-applications" class="slide level2">
<h2>Front-end web applications!</h2>
<p> </p>
<p>Compile Reason into clean performant Javascript</p>
<h4 id="using-the-bucklescript-compiler">using the BuckleScript compiler</h4>
<aside class="notes">
<p>Those were the traditional applications of OCaml.</p>
<p>OCaml can also be used to build front-end web applications, and that’s what this talk is about.</p>
<p>The regular OCaml compiler emits executable binary, but we want Javascript so it executes on the browser. So there is an OCaml compiler called BuckleScript that emits performant Javascript. And it lets us use any npm library in the OCaml code almost seamlessly.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">if</span> (<span class="va">MomentRe</span>.<span class="va">Moment</span>.<span class="at">isSameWithGranularity</span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>      <span class="va">MomentRe</span>.<span class="at">momentNow</span>()<span class="op">,</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>      <span class="va">MomentRe</span>.<span class="at">moment</span>(<span class="st">&quot;2020-04-01&quot;</span>)<span class="op">,</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>      <span class="vs">`day,</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="vs">    )) {</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="vs">  Js.log(&quot;It is the 1st of April!&quot;);</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="vs">} else {</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="vs">  Js.log(&quot;A dreary day&quot;);</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="vs">};</span></span></code></pre></div>
<aside class="notes">
<p>This Reason code here - it checks whether the current day is April 1st 2020, and then shows a message.</p>
<p>It uses the momentjs Javascript library from npm. Now let’s see how the BuckleScript output looks.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">&#39;use strict&#39;</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">var</span> Moment <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;moment&quot;</span>)<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">var</span> MomentRe <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;bs-moment/src/MomentRe.js&quot;</span>)<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="cf">if</span> (<span class="at">Moment</span>().<span class="at">isSame</span>(<span class="va">MomentRe</span>.<span class="at">moment</span>(<span class="kw">undefined</span><span class="op">,</span> <span class="st">&quot;2020-04-01&quot;</span>)<span class="op">,</span> <span class="st">&quot;day&quot;</span>)) <span class="op">{</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;It is the 1st of April!&quot;</span>)<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;A dreary day&quot;</span>)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="op">}</span></span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">/*  Not a pure module */</span></span></code></pre></div>
<aside class="notes">
<p>As you can see BuckleScript required the correct npm module and compiled everything to straightforward Javascript.</p>
</aside>
</section>
<section id="javascript-vs-reason" class="slide level2">
<h2>Javascript vs Reason</h2>
<ul>
<li><p><strong>Javascript</strong>: <code>this</code>, variable hoisting, prototypes, ES6 classes, objects, mutations, <em>functions, modules</em></p></li>
<li><p><strong>Reason</strong>: <em>functions, modules, types</em></p></li>
</ul>
<aside class="notes">
<p>Javascript however is a large language – it has far too many concepts – and that is obvious if you’ve participated in any Javascript interview. You can ask and be asked so many questions. There is the concept of <code>this</code>, there is prototypes and prototype inheritance chains which have their own rules, and there are also classes, objects, and mutation. It also has functions and higher-order functions.</p>
<p>Reason comparatively is a smaller language. It only has functions, modules, and types. We don’t, for example, concern ourselves with what <code>this</code> could be during runtime. In fact a Reason interview would be a rather unexciting event - there aren’t that many quirks to the language to deal with.</p>
</aside>
</section>
<section id="programming-in-reason" class="slide level2">
<h2>Programming in Reason</h2>
<p>Two principles:</p>
<ol type="1">
<li>Write pure functions</li>
<li>Get their types right</li>
</ol>
<aside class="notes">
<p>The way we program Reason is to write our programs as a series of pure functions. That’s it.</p>
<p>But how is that an improvement over Javascript? We can write Javascript in a similar manner - with pure functions everywhere, and just an outer shell for all the I/O. That’s essentially functional programming, and that’s pretty nice.</p>
<p>But Reason is not only “functional”, it is also “typed”, and the types guarantee something:</p>
</aside>
</section>
<section id="perfection" class="slide level2">
<h2>Perfection</h2>
<p>The perfect computer program –</p>
<aside class="notes">
<p>“perfection”.</p>
<p>Reason functions are more “perfect” than functions written in Javascript. I’m using the word “perfection” here, based on a talk given by Prof. Xavier Leroy, who is a programming languages researcher and also the author OCaml</p>
</aside>
</section>
<section class="slide level2">

<blockquote>
<p>(a perfect program is) The one that does exactly what it should do, no more, no less, every time, with perfect reliability, and forever. The kind of perfection that you can get from mathematical definitions, which software is to a large extent, or from philosophical concepts.</p>
</blockquote>
<p><sub><sup>“In search of software perfection”, by Dr. Xavier Leroy, author of OCaml</sub></sup></p>
<aside class="notes">
<p>“A perfect program does exactly what it should do, no more, no less, every time, with perfect reliability, and forever. The kind of perfection that you can get from mathematical definitions, which software is to a large extent, or from philosophical concepts.”</p>
<p>What can that mean in the context of our day-to-day programming work? Let’s take a look.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">let</span> showNext <span class="op">=</span> lastUser <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">lastUser</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="dv">16</span><span class="op">}</span>)</span></code></pre></div>
<pre><code>You will be user 17</code></pre>
<aside class="notes">
<p>Consider this function <code>showNext</code> - it tells you what your user id could be, based on the last user in the system.</p>
<p>We pass it an object with id 16, and it prints 17. The code is as simple as it can get.</p>
<p>But does it work perfectly reliably all the time, every time? Will it ever crash in production?</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="kw">null</span>)</span></code></pre></div>
<aside class="notes">
<p>What if <code>id</code> is null?</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="kw">null</span>)</span></code></pre></div>
<pre><code>You will be user 1</code></pre>
<aside class="notes">
<p>Thankfully that works. Our function is resilient to nulls.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="st">&quot;193&quot;</span><span class="op">}</span>)</span></code></pre></div>
<aside class="notes">
<p>What if id was a string?</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="st">&quot;193&quot;</span><span class="op">}</span>)</span></code></pre></div>
<pre><code>You will be user 1931</code></pre>
<aside class="notes">
<p>It doesn’t crash, but the result isn’t what we wanted.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb19"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1"></a><span class="at">showNext</span>(<span class="op">{}</span>)</span></code></pre></div>
<aside class="notes">
<p>Now what happens when the object is empty?</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb21"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1"></a><span class="at">showNext</span>(<span class="op">{}</span>)</span></code></pre></div>
<pre><code>You will be user NaN</code></pre>
<aside class="notes">
<p>This is also a wrong result.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb24"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">let</span> users <span class="op">=</span> []</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">let</span> lastUser <span class="op">=</span> users[<span class="va">users</span>.<span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="at">showNext</span>(lastUser)</span></code></pre></div>
<aside class="notes">
<p>Here we have a list of users, and we’ll find the last of them and apply to <code>showNext</code></p>
<p>But unfortunately, the list is empty. What happens now?</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb26"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">+</span> (<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">let</span> users <span class="op">=</span> []</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="kw">let</span> lastUser <span class="op">=</span> users[<span class="va">users</span>.<span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="at">showNext</span>(lastUser)</span></code></pre></div>
<pre><code>Uncaught TypeError: Cannot read property &#39;id&#39; of undefined</code></pre>
<aside class="notes">
<p>The function actually crashes.</p>
<p>This is a common source of error when programming in JS - we fetch a value from an array or an object – and sometimes it doesn’t exist – which means it returns a null or an undefined. We then pass that down to other functions.. and things crash in production. Sometimes they crash far away from the place where the undefined originated, and so we have to work backwards quite a bit to debug it.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb29"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb29-1"><a href="#cb29-1"></a><span class="at">showNext</span>()</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="st">&quot;a&quot;</span><span class="op">}</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="op">{}}</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="at">showNext</span>(<span class="kw">undefined</span>)</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="at">showNext</span>(<span class="kw">null</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="at">showNext</span>(<span class="dv">0</span>)</span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="at">showNext</span>(<span class="st">&quot;a&quot;</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="at">showNext</span>([])</span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="at">showNext</span>([<span class="dv">1</span>])</span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="at">showNext</span>(a <span class="kw">=&gt;</span> a <span class="op">+</span> <span class="dv">1</span>)</span></code></pre></div>
<aside class="notes">
<p>Okay, to make a long story short, none of the invokations here would work correctly.</p>
</aside>
</section>
<section class="slide level2">

</section>
<section class="slide level2">

<div class="sourceCode" id="cb30"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb30-1"><a href="#cb30-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="dv">112</span><span class="op">}</span>)</span></code></pre></div>
<pre><code>You will be user 113</code></pre>
<aside class="notes">
<p>The only way the function can succeed is when it receives an object which has a field <code>id</code>, which has an integer value.</p>
<p>So why does Javascript allow this function to be called with any other kind of argument? What if we could write functions that will always work because they always receive the right kind of data. It will change the way we write software.</p>
<p>This is done in Reason with type definitions - it is sort of a metadata that mentions what the shape and structure of different values in the program are.</p>
<p>Let’s see how that works.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb32"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb32-1"><a href="#cb32-1"></a>type user <span class="op">=</span> <span class="op">{</span></span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="op">}</span></span></code></pre></div>
<aside class="notes">
<p>Here is a Reason type definition; we’re saying that there is a type called user</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb33"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1"></a>type user <span class="op">=</span> <span class="op">{</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>  id</span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="op">}</span></span></code></pre></div>
<aside class="notes">
<p>which has a field <code>id</code></p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb34"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb34-1"><a href="#cb34-1"></a>type user <span class="op">=</span> <span class="op">{</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="dt">id</span><span class="op">:</span> int</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="op">};</span></span></code></pre></div>
<aside class="notes">
<p>whose values are always integers.</p>
<p>Now let’s write <code>showNext</code> in Reason.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb35"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb35-1"><a href="#cb35-1"></a>type user <span class="op">=</span> <span class="op">{</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="dt">id</span><span class="op">:</span> int</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="op">};</span></span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="va">Js</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">++</span> <span class="at">string_of_int</span>(<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="op">};</span></span></code></pre></div>
<aside class="notes">
<p>You can see that there is an explicit cast from integer to string, but otherwise the Reason version looks similar to the ES6 version. Let us run it.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb36"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb36-1"><a href="#cb36-1"></a>type user <span class="op">=</span> <span class="op">{</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="dt">id</span><span class="op">:</span> int</span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="op">};</span></span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="va">Js</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">++</span> <span class="at">string_of_int</span>(<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="op">};</span></span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="dv">15</span><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<pre><code>You will be user 16</code></pre>
<aside class="notes">
<p>It works. Can we send this function invalid data, and break it, like we did with the JS version?</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb38"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb38-1"><a href="#cb38-1"></a>type user <span class="op">=</span> <span class="op">{</span> <span class="dt">id</span><span class="op">:</span> int <span class="op">};</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="va">Js</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">++</span> <span class="at">string_of_int</span>(<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="op">};</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="st">&quot;abc&quot;</span><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p><img data-src="images/comp-error-string1.png" /></p>
<aside class="notes">
<p>Yes it breaks! But this is a compile-time breakage. This means no Javascript code was generated for this Reason program we wrote.</p>
<p>That’s because the compiler found a type error in the code.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb39"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb39-1"><a href="#cb39-1"></a>type user <span class="op">=</span> <span class="op">{</span> <span class="dt">id</span><span class="op">:</span> int <span class="op">};</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw">let</span> showNext <span class="op">=</span> u <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="va">Js</span>.<span class="at">log</span>(<span class="st">&quot;You will be user &quot;</span> <span class="op">++</span> <span class="at">string_of_int</span>(<span class="va">u</span>.<span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="op">};</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="st">&quot;abc&quot;</span><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p><img data-src="images/comp-error-string2.png" /></p>
<aside class="notes">
<p>It inferred that the function <code>showNext</code> expects a value of type <code>user</code>, which should have an integer id column in it. But we sent it a string. That will most definitely break the function, so Reason wouldn’t allow it to move past compilation.</p>
<p>But how did Reason figure out that <code>showNext</code> expects a value of type <code>user</code>? When it compiled the code, it knew that were no other types in the vicinity that has an <code>id</code> field apart from the type <code>user</code>. And <code>showNext</code> was expecting its argument to have an <code>id</code>. This mechanism is called type inference.</p>
<p>Let’s see how Reason fares with other invalid values.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb40"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb40-1"><a href="#cb40-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> []<span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p><img data-src="images/comp-error-list.png" /></p>
<aside class="notes">
<p>We get the similar type errors with other invalid values.</p>
</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb41"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb41-1"><a href="#cb41-1"></a><span class="at">showNext</span>(a <span class="kw">=&gt;</span> a <span class="op">+</span> <span class="dv">1</span>)<span class="op">;</span></span></code></pre></div>
<p><img data-src="images/comp-error-fn.png" /></p>
</section>
<section class="slide level2">

</section>
<section class="slide level2">

<h3 id="programming-is-difficult">Programming is difficult</h3>
<ul>
<li>because of clerical errors</li>
<li>logical mistakes are rare</li>
</ul>
<aside class="notes">
<p>So the only code that gets compiled is the one that calles showNext with the right data.</p>
<p>So if it compiles, we can stop being anxious whether we made a mistake or not. If it compiles, it works.</p>
<p>One insight that I learnt from this is that we are all pretty good.</p>
</aside>
<div class="sourceCode" id="cb42"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb42-1"><a href="#cb42-1"></a><span class="at">showNext</span>(<span class="op">{</span><span class="dt">id</span><span class="op">:</span> <span class="kw">null</span><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p><img data-src="images/comp-error-1-null.png" /></p>
<aside class="notes">
<p>But what about null? What if we pass null to <code>showNext</code>?</p>
<p>Again the code does not compile. This is because Reason doesn’t even have the concept of nulls. the concept of nulls. So instead of allowing to run the code and crash at runtime, it simply prevents the code from even being even executed.</p>
<p>But we use nulls in Javascript to represent the “absence” of something. Reason does have an elegant way to do that. I will show how that works soon.</p>
</aside>
</section>
<section class="slide level2">

<p><img data-src="images/parsing-membrane.svg" /></p>
<aside class="notes">

</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb43"><pre class="sourceCode javascript"><code class="sourceCode javascript"></code></pre></div>
<aside class="notes">

</aside>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb44"><pre class="sourceCode javascript"><code class="sourceCode javascript"></code></pre></div>
<aside class="notes">

</aside>
</section>
<section id="the-cost-of-drama" class="slide level2">
<h2>The cost of Drama</h2>
<aside class="notes">
<p>Let’s build a tiny invoicing program. It is for a drama troupe. They put two kinds of plays: Comedies and Tragedies.</p>
</aside>
</section>
<section id="first-step" class="slide level2">
<h2>First step</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb45-1"><a href="#cb45-1"></a><span class="cf">switch</span> (<span class="va">play</span>.<span class="at">type</span>) <span class="op">{</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="cf">case</span> <span class="st">&quot;tragedy&quot;</span><span class="op">:</span>  </span>
<span id="cb45-3"><a href="#cb45-3"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="at">TragedyCalculator</span>(</span>
<span id="cb45-4"><a href="#cb45-4"></a>      aPerformance<span class="op">,</span> aPlay</span>
<span id="cb45-5"><a href="#cb45-5"></a>    )<span class="op">;</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>    </span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="cf">case</span> <span class="st">&quot;comedy&quot;</span><span class="op">:</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>    thisAmount <span class="op">=</span> <span class="dv">30000</span><span class="op">;</span></span>
<span id="cb45-9"><a href="#cb45-9"></a>    <span class="cf">if</span> (<span class="va">perf</span>.<span class="at">audience</span> <span class="op">&gt;</span> <span class="dv">20</span>) <span class="op">{</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>      thisAmount <span class="op">+=</span> <span class="dv">10000</span> <span class="op">+</span> <span class="dv">500</span> <span class="op">*</span> (<span class="va">perf</span>.<span class="at">audience</span> <span class="op">-</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>    <span class="op">}</span></span>
<span id="cb45-12"><a href="#cb45-12"></a>    thisAmount <span class="op">+=</span> <span class="dv">300</span> <span class="op">*</span> <span class="va">perf</span>.<span class="at">audience</span><span class="op">;</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>    <span class="cf">break</span><span class="op">;</span></span>
<span id="cb45-14"><a href="#cb45-14"></a>  <span class="cf">default</span><span class="op">:</span></span>
<span id="cb45-15"><a href="#cb45-15"></a>    <span class="cf">throw</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="vs">`unknown type: </span><span class="sc">${</span><span class="va">play</span>.<span class="at">type</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="op">}</span></span></code></pre></div>
</section>
<section id="code-example" class="slide level2">
<h2>Code example</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb46-1"><a href="#cb46-1"></a>type type_ <span class="op">=</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="op">|</span> Tragedy</span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="op">|</span> Comedy<span class="op">;</span></span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a>type play <span class="op">=</span> <span class="op">{</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="dt">name</span><span class="op">:</span> string<span class="op">,</span></span>
<span id="cb46-7"><a href="#cb46-7"></a>  <span class="dt">audience</span><span class="op">:</span> int<span class="op">,</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>  type_<span class="op">,</span></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="op">};</span></span></code></pre></div>
</section>
    </div>
  </div>

  <script src="./js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration      
      Reveal.initialize({
        history: true,
        transition: 'fade',
        transitionSpeed: 'fast',
        center: false,
        dependencies: [
          { src: './lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: './plugin/zoom-js/zoom.js', async: true },
          { src: './plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
